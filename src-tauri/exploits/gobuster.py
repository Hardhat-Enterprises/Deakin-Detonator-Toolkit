import subprocess
import sys
import json

def run_gobuster(url, wordlist, timeout):
    command = f"gobuster dir -u {url} -w {wordlist} -t {timeout}"
    process = subprocess.Popen(command.split(), stdout=subprocess.PIPE, stderr=subprocess.PIPE)

    output, error = process.communicate()

    return {
        'command': command,
        'output': output.decode(),
        'error': error.decode()
    }

if __name__ == '__main__':
    if len(sys.argv) != 7:
        print("Usage: python gobuster.py -u <url> -w <wordlist> -t <timeout>")
        sys.exit(1)

    if sys.argv[1] == '-u':
        url = sys.argv[2]
    else:
        print("Invalid option: -u <url>")
        sys.exit(1)

    if sys.argv[3] == '-w':
        wordlist = sys.argv[4]
    else:
        print("Invalid option: -w <wordlist>")
        sys.exit(1)

    if sys.argv[5] == '-t':
        timeout = sys.argv[6]
    else:
        print("Invalid option: -t <timeout>")
        sys.exit(1)

    result = run_gobuster(url, wordlist, timeout)

    print(json.dumps(result))
