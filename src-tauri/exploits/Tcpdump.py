import subprocess
import ipaddress

count =0
address = "192.168.199.29"

#Function captures first x packets on any interface, working
def opentcp(count):

    try:
        tcpdump = subprocess.Popen("tcpdump -i any -c " +str(count), stdin=subprocess.PIPE, 
                               stdout=subprocess.PIPE, shell=True)
        for row in iter(tcpdump.stdout.readline, b''):
            print (row.rstrip())
    except:
        print("Operation could not be completed")

    

#function to set IP addr and count, not recognising passed in IP address
def ipandcount(ipaddr, count):
    try:
        tcpdump = subprocess.Popen(" tcpdump -i " + ipaddr + " -c " + str(count), stdin=subprocess.PIPE,
                               stdout=subprocess.PIPE, shell=True)
        for row in iter(tcpdump.stdout.readline, b''):
            print (row.rstrip())
    except:
        print("Error")


#Prints first n packets from eth0 interface, packet data to stdout.
def interface(count):

    try: 
        tcpdump = subprocess.Popen("tcpdump -i eth0 -c " +str(count), stdin=subprocess.PIPE, 
                            stdout=subprocess.PIPE, shell=True)
        for row in iter(tcpdump.stdout.readline, b''):
            print (row.rstrip())
    except:
        print("Error")


    

#opentcp(5)
#ipandcount(address,5)
interface(5)


#3 use cases, 