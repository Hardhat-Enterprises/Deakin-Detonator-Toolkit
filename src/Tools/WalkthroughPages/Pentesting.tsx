import { Image, Text, useMantineTheme, Stack, Title } from "@mantine/core";

const Pentesting = () => {
    const theme = useMantineTheme();
    const getColor = (color: string) => theme.colors[color][theme.colorScheme === "dark" ? 5 : 7];

    return (
        <>
            <Stack align={"center"}>
                <Title>Walkthrough for brute force and hash cracking</Title>
                <Text>
                    This walkthrough is for a Basic Pentesting room in TryHackme which required us to perform brute
                    forcing and hash cracking{" "}
                </Text>
                <Text>
                    {" "}
                    I first connected to the room using OpenVPN configuration File. I got the IP address of room from
                    the website. For this trial, our ip was 10.10.34.63{" "}
                </Text>
                <Text> I then scanned the machine for vulnurabilities using Nmap tool. The command for this is </Text>
                <Text>
                    {" "}
                    sudo nmap -A -T5 -Pn 10.10.34.63
                    <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                        <Image radius="md" src="https://i.imgur.com/yTQs9pP.png" alt="nmap_res" />
                    </div>
                </Text>
                <Text>
                    {" "}
                    I then tried to find any hidden directorties in the system. I used the tool GoBuster to find hidden
                    directory using a dictionary of common words common.txt The command for this is:{" "}
                </Text>
                <Text> gobuster dir -w /usr/share/dirb/wordlists/common.txt -u http://10.10.36.109 </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/pktKmBF.png" alt="nmap_res" />
                </div>

                <Text>
                    {" "}
                    I found a hidden directory with the name of development which can be accessed through ip
                    http://10.10.34.63/development. It contained the files dev.txt and j.txt which contains the
                    following content{" "}
                </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/2OLVvCN.png" alt="nmap_res" />
                </div>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/PsF3T5I.png" alt="nmap_res" />
                </div>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/shCTWLt.png" alt="nmap_res" />
                </div>

                <Text>
                    By going through the file j.txt, we can see that one of the account has a weak password. To try to
                    find the username, I used the tool enum4linux. I used the command:
                </Text>
                <Text> enum4linux 10.10.36.109 </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/IKsZZVf.png" alt="nmap_res" />
                </div>

                <Text>
                    {" "}
                    We can see that there are 2 users Jan and kay. From the file dev.txt we can infer that the account
                    of user Jay has a weak password. To try to get the password for user Jan, I used the tool hydra. It
                    tries to crack the password of user jan through the file rockyou.txt which contains common
                    passwords. The command for this is :{" "}
                </Text>
                <Text> hydra -l jan -P /usr/share/wordlist/rockyou.txt -t 4 ssh://10.10.34.63 </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/qootqg7.png" alt="nmap_res" />
                </div>

                <Text>
                    {" "}
                    Here, we can see that the password for user Jan is "armando". I then used ssh with credentials of
                    Jan to access the system. I was successful. I tried to find any password file. I was successful in
                    finding password.bak but it was in the folder of Kay user and thus could not be accessed. I then
                    tried to find any hidden files using the tool ls. It gave the following result:
                </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/Pg1L1az.png" alt="nmap_res" />
                </div>
                <Text>
                    {" "}
                    We can see that there is a hidden folder called ssh. I went through its contents and found a file
                    id_rsa. I copied the file into my local system. To crack the password from this file, I first tried
                    to find the hash value using ssh2john.py script present in JohnTheRipper extended package. The
                    command for this is :{" "}
                </Text>
                <Text> python /usr/share/john/ssh2john.py id_rsa {">"} id_rsa.hash </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/wH5SpeF.png" alt="nmap_res" />
                </div>
                <Text>
                    {" "}
                    I was successful in finding the hash. I then tried to crack the hash value using john the ripper
                    tool with the help of rockyou.txt which contains common passwords. The command for this is:{" "}
                </Text>
                <Text> john --wordlist=rockyou.txt id_rsa.hash </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/sNckQDG.png" alt="nmap_res" />
                </div>
                <Text>
                    {" "}
                    This led to discovery of the password for user Kay which came out to be "beeswax". I then ssh into
                    the system using id_rsa. For this, we have to make it secure so I used the command "chmod 400
                    id_rsa" so that it is trusted by the system. The command of ssh is:{" "}
                </Text>
                <div style={{ width: 400, marginLeft: "auto", marginRight: "auto" }}>
                    <Image radius="md" src="https://i.imgur.com/hnnAfIK.png" alt="nmap_res" />
                </div>
                <Text> ssh -i id_rsa kay@10.10.34.63 </Text>

                <Text>
                    {" "}
                    I was able to get access to the system from the user Kay. This allowed me to read password.bak which
                    led me to the password of user Kay which is
                    "heresareallystrongpasswordthatfollowsthepasswordpolicy$$ "{" "}
                </Text>
                <Text>
                    Thus, a successful privilege escalation attack was launched against a system by exploiting the weak
                    password of a system
                </Text>
            </Stack>
        </>
    );
};

export default Pentesting;
